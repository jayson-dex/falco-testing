- rule: Unexpected TCP Traffic
  desc: >
    Detecting TCP traffic on ports other than 53 (DNS) or other commonly used ports. Misusing UDP is a known TTP among attackers. 
    Monitoring unusual network activity is highly valuable but often generates significant noise, as is the case with this detection.
  condition: >
    inbound
    and fd.l4proto=tcp
    and not fd.port in [33333]
  output: Unexpected TCP Traffic Seen (connection=%fd.name sport=%fd.sport lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)
  priority: NOTICE
  tags:
    [maturity_incubating, host, container, network, mitre_exfiltration, TA0011]
